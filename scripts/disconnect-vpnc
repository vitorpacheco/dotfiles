#!/usr/bin/env bash
set -euo pipefail

echo "ðŸ”Œ Stopping vpnc..."
sudo vpnc-disconnect

# Restore original DNS configuration
if [[ -f /etc/resolv.conf.backup-vpn ]]; then
  echo "ðŸ”„ Restoring original DNS configuration..."
  sudo mv /etc/resolv.conf.backup-vpn /etc/resolv.conf
fi

# Refresh DNS
if command -v resolvconf >/dev/null; then
  echo "ðŸ”„ Updating resolvconf..."
  sudo resolvconf -u
else
  echo "ðŸ”„ Flushing systemd-resolved cache..."
  sudo systemd-resolve --flush-caches || true
fi

echo "âœ… VPNC tunnel is down and DNS restored."
